# Request definition
# 请求定义：[请求者, 请求的资源, 请求的动作]
[request_definition]
r = sub, obj, act

# Policy definition
# 策略定义：[策略规则的组成部分]
[policy_definition]
p = sub, obj, act

# Role definition
# 角色定义：g 是角色继承关系，_ 表示角色，_ 表示用户
# g = _, _  表示前面的角色/用户继承了后面的角色的权限
[role_definition]
g = _, _

# Policy effect
# 策略效果：当至少有一条策略规则匹配并且结果为 allow 时，请求就被允许
[policy_effect]
e = some(where (p.eft == allow))

# Matchers
# 匹配器：定义如何匹配请求和策略
# r.sub == p.sub：请求的主体(用户/角色)与策略中的主体匹配
# r.obj == p.obj：请求的资源与策略中的资源匹配
# r.act == p.act：请求的动作与策略中的动作匹配
# g(r.sub, p.sub) 是一个关键函数，表示 r.sub (请求者) 是否属于 p.sub (策略中定义的角色)
[matchers]
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act